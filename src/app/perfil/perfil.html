<div class="perfil-container">
    <h2>Gestión de Perfiles Familiares</h2>
    
    <!-- Selector de personas -->
    <div class="selector-personas">
      <h3>Seleccionar Persona</h3>
      <div class="personas-lista" *ngIf="personas.length > 0">
        <div 
          *ngFor="let persona of personas" 
          class="persona-card"
          [class.selected]="personaSeleccionada?.id === persona.id"
          (click)="seleccionarPersona(persona)"
        >
          <div class="persona-info">
            <strong>{{ persona.nombre || 'Sin nombre' }}</strong>
            <span>{{ persona.edad ? persona.edad + ' años' : '' }}</span>
          </div>
          <button 
            class="btn-eliminar" 
            (click)="eliminarPersona($event, persona.id!)"
            title="Eliminar persona"
          >
            ×
          </button>
        </div>
      </div>
      
      <button class="btn-nueva-persona" (click)="nuevaPersona()">
        + Nueva Persona
      </button>
    </div>

    <!-- Formulario de datos -->
    <div class="formulario-persona" *ngIf="mostrarFormulario">
      <h3>{{ modoEdicion ? 'Editar Persona' : 'Nueva Persona' }}</h3>
      
      <form (ngSubmit)="guardarPersona()">
        <div class="form-group">
          <label for="nombre">Nombre:</label>
          <input
            type="text"
            id="nombre"
            placeholder="Nombre"
            [(ngModel)]="personaForm.nombre"
            name="nombre"
            required
          />
        </div>

        <div class="form-group">
          <label for="edad">Edad:</label>
          <input
            type="number"
            id="edad"
            placeholder="Edad"
            [(ngModel)]="personaForm.edad"
            name="edad"
            min="0"
            max="120"
          />
        </div>

        <div class="form-group">
          <label for="altura">Altura (cm):</label>
          <input
            type="number"
            id="altura"
            placeholder="Altura"
            [(ngModel)]="personaForm.altura"
            name="altura"
            min="50"
            max="250"
            step="0.1"
          />
        </div>

        <div class="form-group">
          <label for="peso">Peso (kg):</label>
          <input
            type="number"
            id="peso"
            placeholder="Peso"
            [(ngModel)]="personaForm.peso"
            name="peso"
            min="1"
            max="500"
            step="0.1"
          />
        </div>

        <div class="form-buttons">
          <button type="submit" class="btn-guardar">
            {{ modoEdicion ? 'Actualizar' : 'Guardar' }}
          </button>
          <button type="button" class="btn-cancelar" (click)="cancelar()">
            Cancelar
          </button>
        </div>
      </form>
    </div>

    <!-- Información de la persona seleccionada -->
    <div class="info-persona" *ngIf="personaSeleccionada && !mostrarFormulario">
      <h3>Información de {{ personaSeleccionada.nombre }}</h3>
      
      <div class="datos-persona">
        <div class="dato">
          <strong>Nombre:</strong> 
          <span>{{ personaSeleccionada.nombre || 'No especificado' }}</span>
        </div>
        <div class="dato">
          <strong>Edad:</strong> 
          <span>{{ personaSeleccionada.edad ? personaSeleccionada.edad + ' años' : 'No especificado' }}</span>
        </div>
        <div class="dato">
          <strong>Altura:</strong> 
          <span>{{ personaSeleccionada.altura ? personaSeleccionada.altura + ' cm' : 'No especificado' }}</span>
        </div>
        <div class="dato">
          <strong>Peso:</strong> 
          <span>{{ personaSeleccionada.peso ? personaSeleccionada.peso + ' kg' : 'No especificado' }}</span>
        </div>
      </div>

      <button class="btn-editar" (click)="editarPersona()">
        Editar Datos
      </button>
    </div>

    <!-- Mensaje cuando no hay personas -->
    <div class="mensaje-vacio" *ngIf="personas.length === 0">
      <p>No hay personas registradas en la familia.</p>
      <p>Haz clic en "Nueva Persona" para añadir la primera.</p>
    </div>
  </div>
